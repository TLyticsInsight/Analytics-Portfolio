name: Qiita Sync

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 0 * * *'  # 毎日0時に実行（スケジュール実行）

jobs:
  fetch_qiita_articles:
    runs-on: ubuntu-latest

    steps:
      - name: Check out the repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install git+https://x-access-token:${{ secrets.1fb437f4aadfd3c6cb3d67104a036e0725bba0e3 }}@github.com/TLyticsInsight/qiita-cli.git

      - name: Fetch Qiita articles
        env:
          QIITA_TOKEN: ${{ secrets.QIITA_TOKEN }}
        run: |
          qiita-cli articles list --access-token $QIITA_TOKEN
